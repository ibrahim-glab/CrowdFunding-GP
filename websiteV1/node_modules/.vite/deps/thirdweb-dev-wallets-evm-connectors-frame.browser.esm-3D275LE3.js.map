{
  "version": 3,
  "sources": ["../../@thirdweb-dev/wallets/evm/connectors/frame/dist/thirdweb-dev-wallets-evm-connectors-frame.browser.esm.js"],
  "sourcesContent": ["import { _ as _classPrivateFieldInitSpec, a as _classPrivateFieldSet, b as _classPrivateFieldGet } from '../../../../dist/classPrivateFieldSet-a5db7c83.browser.esm.js';\nimport { _ as _defineProperty } from '../../../../dist/defineProperty-d7c057bf.browser.esm.js';\nimport { utils, providers } from 'ethers';\nimport { W as WagmiConnector } from '../../../../dist/WagmiConnector-2f14002d.browser.esm.js';\nimport { a as ConnectorNotFoundError, U as UserRejectedRequestError, R as ResourceUnavailableError, C as ChainNotConfiguredError, A as AddChainError, S as SwitchChainError } from '../../../../dist/errors-9f6736cb.browser.esm.js';\nimport { g as getValidPublicRPCUrl } from '../../../../dist/url-a45219bd.browser.esm.js';\nimport { n as normalizeChainId } from '../../../../dist/normalizeChainId-1fb9aedf.browser.esm.js';\nimport '@thirdweb-dev/chains';\nimport 'eventemitter3';\n\nvar _provider = /*#__PURE__*/new WeakMap();\nclass FrameConnector extends WagmiConnector {\n  constructor(_ref) {\n    let {\n      chains,\n      options: suppliedOptions,\n      connectorStorage\n    } = _ref;\n    const options = {\n      shimDisconnect: true,\n      ...suppliedOptions\n    };\n    super({\n      chains,\n      options\n    });\n    _defineProperty(this, \"id\", \"frame\");\n    _defineProperty(this, \"name\", \"Frame\");\n    _defineProperty(this, \"ready\", true);\n    _defineProperty(this, \"shimDisconnectKey\", `${this.id}.shimDisconnect`);\n    _classPrivateFieldInitSpec(this, _provider, {\n      writable: true,\n      value: void 0\n    });\n    _defineProperty(this, \"onAccountsChanged\", accounts => {\n      if (accounts.length === 0) {\n        this.emit(\"disconnect\");\n      } else {\n        this.emit(\"change\", {\n          account: utils.getAddress(accounts[0])\n        });\n      }\n    });\n    _defineProperty(this, \"onChainChanged\", chainId => {\n      const id = normalizeChainId(chainId);\n      const unsupported = this.isChainUnsupported(id);\n      this.emit(\"change\", {\n        chain: {\n          id,\n          unsupported\n        }\n      });\n    });\n    _defineProperty(this, \"onDisconnect\", () => {\n      this.emit(\"disconnect\");\n      // Remove shim signalling wallet is disconnected\n      if (this.options.shimDisconnect) {\n        this.connectorStorage.removeItem(this.shimDisconnectKey);\n      }\n    });\n    this.connectorStorage = connectorStorage;\n  }\n  async connect(config) {\n    try {\n      const provider = await this.getProvider();\n      if (!provider) {\n        throw new ConnectorNotFoundError();\n      }\n      this.setupListeners();\n      this.emit(\"message\", {\n        type: \"connecting\"\n      });\n      const accounts = await provider.request({\n        method: \"eth_requestAccounts\"\n      });\n      const account = utils.getAddress(accounts[0]);\n      // Switch to chain if provided\n      let id = await this.getChainId();\n      let unsupported = this.isChainUnsupported(id);\n      if (config?.chainId && id !== config?.chainId) {\n        const chain = await this.switchChain(config?.chainId);\n        id = chain.chainId;\n        unsupported = this.isChainUnsupported(id);\n      }\n\n      // Add shim to storage signalling wallet is connected\n      if (this.options.shimDisconnect) {\n        this.connectorStorage.setItem(this.shimDisconnectKey, \"true\");\n      }\n      return {\n        account,\n        provider,\n        chain: {\n          id,\n          unsupported\n        }\n      };\n    } catch (error) {\n      if (this.isUserRejectedRequestError(error)) {\n        throw new UserRejectedRequestError(error);\n      }\n      if (error.code === -32002) {\n        throw new ResourceUnavailableError(error);\n      }\n      throw error;\n    }\n  }\n  async disconnect() {\n    const provider = await this.getProvider();\n    if (!provider?.removeListener) {\n      return;\n    }\n    provider.removeListener(\"accountsChanged\", this.onAccountsChanged);\n    provider.removeListener(\"chainChanged\", this.onChainChanged);\n    provider.removeListener(\"disconnect\", this.onDisconnect);\n    if (!this.isInjected()) {\n      provider.close();\n    }\n\n    // Remove shim signalling wallet is disconnected\n    if (this.options.shimDisconnect) {\n      this.connectorStorage.removeItem(this.shimDisconnectKey);\n    }\n  }\n  async getAccount() {\n    const provider = await this.getProvider();\n    if (!provider) {\n      throw new ConnectorNotFoundError();\n    }\n    const accounts = await provider.request({\n      method: \"eth_accounts\"\n    });\n    // return checksum address\n    return utils.getAddress(accounts[0]);\n  }\n  async getChainId() {\n    const provider = await this.getProvider();\n    if (!provider) {\n      throw new ConnectorNotFoundError();\n    }\n    const chainId = await provider.request({\n      method: \"eth_chainId\"\n    });\n    return normalizeChainId(chainId);\n  }\n  async getProvider() {\n    _classPrivateFieldSet(this, _provider, this.isInjected() ? this.injectedProvider() : await this.createProvider());\n    return _classPrivateFieldGet(this, _provider);\n  }\n\n  /**\n   * get a `signer` for given `chainId`\n   */\n  async getSigner() {\n    let {\n      chainId\n    } = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n    const [provider, account] = await Promise.all([this.getProvider(), this.getAccount()]);\n\n    // ethers.providers.Web3Provider\n    return new providers.Web3Provider(provider, chainId).getSigner(account);\n  }\n  async isAuthorized() {\n    try {\n      if (this.options.shimDisconnect &&\n      // If shim does not exist in storage, wallet is disconnected\n      !this.connectorStorage.getItem(this.shimDisconnectKey)) {\n        return false;\n      }\n      const provider = await this.getProvider();\n      if (!provider) {\n        throw new ConnectorNotFoundError();\n      }\n      const account = await this.getAccount();\n      return !!account;\n    } catch {\n      return false;\n    }\n  }\n  async switchChain(chainId) {\n    const provider = await this.getProvider();\n    if (!provider) {\n      throw new ConnectorNotFoundError();\n    }\n    const chainIdHex = utils.hexValue(chainId);\n    try {\n      await Promise.all([provider.request({\n        method: \"wallet_switchEthereumChain\",\n        params: [{\n          chainId: chainIdHex\n        }]\n      }), new Promise(res => this.on(\"change\", _ref2 => {\n        let {\n          chain\n        } = _ref2;\n        if (chain?.id === chainId) {\n          res();\n        }\n      }))]);\n      return this.chains.find(x => x.chainId === chainId) ?? {\n        chainId: chainId,\n        name: `Chain ${chainIdHex}`,\n        slug: `${chainIdHex}`,\n        nativeCurrency: {\n          name: \"Ether\",\n          decimals: 18,\n          symbol: \"ETH\"\n        },\n        rpc: [\"\"],\n        chain: \"\",\n        shortName: \"\",\n        testnet: true\n      };\n    } catch (switchChainError) {\n      const chain = this.chains.find(x => x.chainId === chainId);\n      if (!chain) {\n        throw new ChainNotConfiguredError({\n          chainId,\n          connectorId: this.id\n        });\n      }\n\n      // Indicates chain is not added to provider\n      if (switchChainError.code === 4902) {\n        try {\n          await provider.request({\n            method: \"wallet_addEthereumChain\",\n            params: [{\n              chainId: chainIdHex,\n              chainName: chain.name,\n              nativeCurrency: chain.nativeCurrency,\n              rpcUrls: getValidPublicRPCUrl(chain),\n              // no client id on purpose here\n              blockExplorerUrls: this.getBlockExplorerUrls(chain)\n            }]\n          });\n          const currentChainId = await this.getChainId();\n          if (currentChainId !== chainId) {\n            throw new UserRejectedRequestError(new Error(\"User rejected switch after adding network.\"));\n          }\n          return chain;\n        } catch (addChainError) {\n          // if user rejects request to add chain\n          if (this.isUserRejectedRequestError(addChainError)) {\n            throw new UserRejectedRequestError(addChainError);\n          }\n\n          // else other error\n          throw new AddChainError(addChainError.message);\n        }\n      }\n\n      // if user rejects request to switch chain\n      if (this.isUserRejectedRequestError(switchChainError)) {\n        throw new UserRejectedRequestError(switchChainError);\n      }\n\n      // else other error\n      throw new SwitchChainError(switchChainError);\n    }\n  }\n  async watchAsset(_ref3) {\n    let {\n      address,\n      decimals = 18,\n      image,\n      symbol\n    } = _ref3;\n    const provider = await this.getProvider();\n    if (!provider) {\n      throw new ConnectorNotFoundError();\n    }\n    return provider.request({\n      method: \"wallet_watchAsset\",\n      params: {\n        type: \"ERC20\",\n        options: {\n          address,\n          decimals,\n          image,\n          symbol\n        }\n      }\n    });\n  }\n  async setupListeners() {\n    const provider = await this.getProvider();\n    if (provider.on) {\n      provider.on(\"accountsChanged\", this.onAccountsChanged);\n      provider.on(\"chainChanged\", this.onChainChanged);\n      provider.on(\"disconnect\", this.onDisconnect);\n    }\n  }\n  isUserRejectedRequestError(error) {\n    return error.code === 4001;\n  }\n  injectedProvider() {\n    return window?.ethereum;\n  }\n  isInjected() {\n    return !!this.injectedProvider()?.isFrame;\n  }\n  async createProvider() {\n    const ethProvider = (await import('eth-provider')).default;\n    return ethProvider(\"frame\");\n  }\n}\n\nexport { FrameConnector };\n"],
  "mappings": "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",
  "names": []
}

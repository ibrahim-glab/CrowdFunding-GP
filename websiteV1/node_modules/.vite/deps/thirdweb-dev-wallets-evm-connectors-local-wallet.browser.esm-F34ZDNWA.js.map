{
  "version": 3,
  "sources": ["../../@thirdweb-dev/wallets/evm/connectors/local-wallet/dist/thirdweb-dev-wallets-evm-connectors-local-wallet.browser.esm.js"],
  "sourcesContent": ["import { _ as _classPrivateFieldInitSpec, a as _classPrivateFieldSet, b as _classPrivateFieldGet } from '../../../../dist/classPrivateFieldSet-a5db7c83.browser.esm.js';\r\nimport { _ as _defineProperty } from '../../../../dist/defineProperty-d7c057bf.browser.esm.js';\r\nimport { n as normalizeChainId } from '../../../../dist/normalizeChainId-1fb9aedf.browser.esm.js';\r\nimport { C as Connector } from '../../../../dist/connector-05689d68.browser.esm.js';\r\nimport { getDefaultGasOverrides, getChainProvider } from '@thirdweb-dev/sdk';\r\nimport { Signer } from 'ethers';\r\nimport { defineReadOnly } from 'ethers/lib/utils';\r\nimport 'eventemitter3';\r\n\r\nclass WrappedSigner extends Signer {\r\n  constructor(signer) {\r\n    super();\r\n    this.signer = signer;\r\n    defineReadOnly(this, \"provider\", signer.provider);\r\n  }\r\n  async getAddress() {\r\n    return await this.signer.getAddress();\r\n  }\r\n  async signMessage(message) {\r\n    return await this.signer.signMessage(message);\r\n  }\r\n  async signTransaction(transaction) {\r\n    return await this.signer.signTransaction(transaction);\r\n  }\r\n  connect(provider) {\r\n    return new WrappedSigner(this.signer.connect(provider));\r\n  }\r\n  _signTypedData(domain, types, value) {\r\n    return this.signer._signTypedData(domain, types, value);\r\n  }\r\n  async sendTransaction(transaction) {\r\n    if (!this.provider) {\r\n      throw new Error(\"Provider not found\");\r\n    }\r\n    const gas = await getDefaultGasOverrides(this.provider);\r\n    const txWithGas = {\r\n      ...gas,\r\n      ...transaction\r\n    };\r\n    return await this.signer.sendTransaction(txWithGas);\r\n  }\r\n}\r\n\r\nvar _provider = /*#__PURE__*/new WeakMap();\r\nvar _signer = /*#__PURE__*/new WeakMap();\r\nclass LocalWalletConnector extends Connector {\r\n  constructor(options) {\r\n    super();\r\n    _defineProperty(this, \"id\", \"local_wallet\");\r\n    _defineProperty(this, \"name\", \"Local Wallet\");\r\n    _classPrivateFieldInitSpec(this, _provider, {\r\n      writable: true,\r\n      value: void 0\r\n    });\r\n    _classPrivateFieldInitSpec(this, _signer, {\r\n      writable: true,\r\n      value: void 0\r\n    });\r\n    _defineProperty(this, \"shimDisconnectKey\", \"localWallet.shimDisconnect\");\r\n    _defineProperty(this, \"onChainChanged\", chainId => {\r\n      const id = normalizeChainId(chainId);\r\n      const unsupported = !this.options.chains.find(c => c.chainId === id);\r\n      this.emit(\"change\", {\r\n        chain: {\r\n          id,\r\n          unsupported\r\n        }\r\n      });\r\n    });\r\n    this.options = options;\r\n  }\r\n  async connect(args) {\r\n    if (args.chainId) {\r\n      this.switchChain(args.chainId);\r\n    }\r\n    const signer = await this.getSigner();\r\n    const address = await signer.getAddress();\r\n    return address;\r\n  }\r\n  async disconnect() {\r\n    _classPrivateFieldSet(this, _provider, undefined);\r\n    _classPrivateFieldSet(this, _signer, undefined);\r\n  }\r\n  async getAddress() {\r\n    const signer = await this.getSigner();\r\n    if (!signer) {\r\n      throw new Error(\"No signer found\");\r\n    }\r\n    return await signer.getAddress();\r\n  }\r\n  async isConnected() {\r\n    try {\r\n      const addr = await this.getAddress();\r\n      return !!addr;\r\n    } catch {\r\n      return false;\r\n    }\r\n  }\r\n  async getProvider() {\r\n    if (!_classPrivateFieldGet(this, _provider)) {\r\n      _classPrivateFieldSet(this, _provider, getChainProvider(this.options.chain, {\r\n        clientId: this.options.clientId,\r\n        secretKey: this.options.secretKey\r\n      }));\r\n    }\r\n    return _classPrivateFieldGet(this, _provider);\r\n  }\r\n  async getSigner() {\r\n    if (!_classPrivateFieldGet(this, _signer)) {\r\n      const provider = await this.getProvider();\r\n      _classPrivateFieldSet(this, _signer, getSignerFromEthersWallet(this.options.ethersWallet, provider));\r\n    }\r\n    return _classPrivateFieldGet(this, _signer);\r\n  }\r\n  async switchChain(chainId) {\r\n    const chain = this.options.chains.find(c => c.chainId === chainId);\r\n    if (!chain) {\r\n      throw new Error(`Chain not found for chainId ${chainId}, please add it to the chains property when creating this wallet`);\r\n    }\r\n    _classPrivateFieldSet(this, _provider, getChainProvider(chain, {\r\n      clientId: this.options.clientId,\r\n      secretKey: this.options.secretKey\r\n    }));\r\n    _classPrivateFieldSet(this, _signer, getSignerFromEthersWallet(this.options.ethersWallet, _classPrivateFieldGet(this, _provider)));\r\n    this.onChainChanged(chainId);\r\n  }\r\n  async setupListeners() {}\r\n  updateChains(chains) {\r\n    this.options.chains = chains;\r\n  }\r\n}\r\nfunction getSignerFromEthersWallet(ethersWallet, provider) {\r\n  let signer = ethersWallet;\r\n  if (provider) {\r\n    signer = ethersWallet.connect(provider);\r\n  }\r\n  return new WrappedSigner(signer);\r\n}\r\n\r\nexport { LocalWalletConnector };\r\n"],
  "mappings": "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",
  "names": []
}
